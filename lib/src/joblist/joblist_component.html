<div id="upload-container">
    <div class="upload-button-wrapper">
        <material-button raised class="upload-button">
            <material-icon class="upload-icon" icon="note_add"></material-icon> PDF hochladen
        </material-button>
        <input class="upload-input" #jobUpload type="file" multiple accept="application/pdf"
            (change)="onUploadFileSelected(jobUpload.files)">
    </div>
</div>

<material-button *ngIf="directPrinter" (trigger)="onPrintAll">
    <material-icon class="button-icon" icon="printer"></material-icon>
    Alle drucken
</material-button>

<material-list>
    <material-list-item class="job-item" *ngFor="let task of uploads">
        <material-spinner class="upload-task-spinner"></material-spinner>
        <div class="jobitem-info">
            <b><span class="filename">{{task?.filename}}</span></b><br>
            <span
                class="timestamp">{{task?.isUploading ? 'Am Hochladen...' : 'Hochladen abgeschlossen - Am Verarbeiten... (Du kannst die Seite jetzt schließen)'}}</span>
        </div>
    </material-list-item>
</material-list>

<material-list id="joblist">
    <a *ngFor="let job of lastJobs.reversed">
        <material-list-item class="job-item">
            <material-button tooltipTarget #refKeep="tooltipTarget" (trigger)="onKeepJob(job.id)">
                <material-icon [icon]="(job.jobOptions.keep) ? 'favorite' : 'favorite_outline'"></material-icon>
                <material-tooltip-text [for]="refKeep">
                    <header>Job nach dem Drucken behalten</header>
                </material-tooltip-text>
            </material-button>
            <div class="jobitem-info" [routerLink]="jobDetailsUrl(job.id)">
                <b><span class="filename">{{job.jobInfo?.filename}}</span></b><br>
                <span class="timestamp">{{DateTime.fromMillisecondsSinceEpoch(job?.timestamp *
                    1000).toString().split('.')[0]}}</span>
            </div>
            <material-button tooltipTarget #refDelete="tooltipTarget" class="delete-button"
                (trigger)="onDeleteJob(job.id)">
                <material-icon icon="delete"></material-icon>
                <material-tooltip-text [for]="refDelete">
                    <header>Job löschen</header>
                </material-tooltip-text>
            </material-button>
            <material-button *ngIf="directPrinter" class="print-button" (trigger)="onOpenPrintDialog(job.id)"
                tooltipTarget #refPrint="tooltipTarget">
                <material-icon icon="printer"></material-icon>
                <material-tooltip-text [for]="refPrint">
                    <header>Job {{ (leftPrinter.isNotEmpty) ? 'links' : 'rechts' }} drucken</header>
                </material-tooltip-text>
            </material-button>
        </material-list-item>
    </a>
</material-list>

<div class="bottom-bar">

</div>

<material-fab tooltipTarget #refRefresh="tooltipTarget" raised id="refreshButton" class="button" [(disabled)]="refreshing" (trigger)="onRefreshJobs()">
    <material-spinner *ngIf="refreshing" class="button-spinner"></material-spinner>
    <material-icon icon="refresh" *ngIf="!refreshing"></material-icon>
    <material-tooltip-text [for]="refRefresh">
        <header>Liste aktualisieren</header>
    </material-tooltip-text>
</material-fab>

<modal [visible]="showSelectPrinter">
    <material-dialog id="selectPrinter">
        <h1 header>Drucker auswählen</h1>
        <div class="printer-selector">
            <material-button *ngIf="leftPrinter.isNotEmpty" class="printer-selection" (trigger)="printJobLeft()">
                <material-icon class="big-ass-icon" icon="keyboard_arrow_left"></material-icon>
                Linker<br>Drucker
            </material-button>
            <material-button *ngIf="rightPrinter.isNotEmpty" class="printer-selection" (trigger)="printJobRight()">
                Rechter<br>Drucker
                <material-icon class="big-ass-icon" icon="keyboard_arrow_right"></material-icon>
            </material-button>
        </div>

        <div footer>
            <material-button autoFocus clear-size (trigger)="showSelectPrinter = false">
                Abbrechen
            </material-button>
        </div>
    </material-dialog>
</modal>